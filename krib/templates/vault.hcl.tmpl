listener "tcp" {
  address          = "0.0.0.0:8200"
  cluster_address  = "{{.Machine.Address}}:8201"
  tls_cert_file = "/etc/vault/pki/server.pem"
  tls_key_file  = "/etc/vault/pki/server-key.pem"
}

storage "raft" {
  path = "/var/lib/vault"
  node_id = "{{.Machine.Name}}"
  # Iterate through all the cluster masters to setup retry_join

  retry_join {
      leader_api_addr = "https://192.168.33.11:8200"
      leader_ca_cert_file = "/etc/vault/pki/server-ca.pem"
    }    
  retry_join {
      leader_api_addr = "https://192.168.33.12:8200"
      leader_ca_cert_file = "/etc/vault/pki/server-ca.pem"
    }    
  retry_join {
      leader_api_addr = "https://192.168.33.13:8200"
      leader_ca_cert_file = "/etc/vault/pki/server-ca.pem"
    }    
            
}

api_addr = "http://{{.Machine.Address}}:8200"
cluster_addr = "https://{{.Machine.Address}}:8201"